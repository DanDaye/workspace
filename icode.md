## 必修课1. 《持续集成与持续部署》（5%）

**持续集成的概念和内容**

CI（持续集成）

**集成**是软件个人研发部分向整体部分组合和交付，以便验证个人研发工作

**持续继承**是一种软件开发实践，团队成员频繁将他们的工作成果集成在一起（通常每人每天至少提交一次，这样每天就会有多次集成）；每次提交后，自动触发运行一次包括自动化验证及的构建任务，以便尽早发现集成问题

CD（持续部署）

**部署**是把集成好的软件包，按照预先设计的方案将其安装到计算节点上，并且保证系统可以正常启动

**持续部署**是指能够`自动化、多批次、可控`地实现软件的部署，控制故障的影响范围或方便轻松解决故障问题

​	持续部署包括的部署或测试部署方法：

​	· 蓝绿部署：维护两个相同的主机环境，一个用于生产、一个用于预发布，轮换使用

​	· 金丝雀部署（灰度部署）：对新版本进行小批量部署，小量流测试，没有问题后逐步加大部署量和引流量，最后把所有流量全部引导到新版本

​	·暗箱发布：新版本被逐步测试和部署到生产环境中，用于开发人员分析与确认后，再通过开关系统开发给所有用户

**常见分支开发模式-主干开发**

![image-20210201194720912](/Users/gertieliang/Library/Application Support/typora-user-images/image-20210201194720912.png)

**常用的CI/CD相关工具**

需求：tapd、iwiki

代码：工蜂git,代码规范，代码评审

构建：代码扫描（codecc,质量红线）、安全扫描（Web漏洞扫描器，APP漏洞（金刚），Web应用防火墙（门神），PCG代码安全审计）、代码加固（游戏apk加固，乐固）

测试和质量：自动化测试（同源测试），UI/终端测试（终端测试平台）

**CI/CD的评估方法**

1. 建立主干、版本分支的部署流水线，代码合入时要触发
2. 提交构建成功率超过85%，流水线耗时小于20分支
3. 生成代码均须经过流水线自动化验证（比如单元测试），自动对接发布系统，完成发布
4. 满足更高的成功率、耗时等评估指标要求

**流水线的设计原则与要素**

1. 一次构建多次使用，当某个流水线的一次运行实例构建出制品，如果需要，它就应该直接被用于该流水线后续阶段的构建过程，而不是在后续阶段中被再次重复构建
2. 与业务逻辑松耦合，部署流水线工具应该与具体的部署构建业务分离
3. 并行化原则，在流水线设计中，我们应该尽可能考虑并行化
4. 快速反馈优先，在资源不足的情况下，部署流水线应该让那些提供快速反馈的任务尽早执行
5. 重要反馈优先，对于反馈机制，不能只因为其执行速度慢，就把它放在后面执行

**流水线插件开发的步骤与方法**



**落地CI/CD的推荐做法**

三步法：

1. 定目标：研发侧与业务侧达成流程规范与目标的认知
2. 圈资源：保持相对固定研发时间投入
3. 数据驱动：通过交付结构数据来持续迭代

相关习题：

1. 以下哪个不是CI/CD特点？
2. 以下哪项是持续集成的内容？
3. 关于CI/CD与流水线，以下哪项不正确？

## 《代码质量与技术债》

### 优秀代码的特质

`CLEAN`

Cohesive:内聚的代码更容易理解和查找bug

Loosely Couple：松耦合的代码让实体之间的副作用更少，更容易测试、复用、扩展

Encapuslate：封装良好的代码有助于管理复杂度，也更容易修改

Assertive：自主的代码其行为和其所依赖的数据放在一起，不与其它代码互相干预

Nonredundant：无冗余的代码意味可以只在一个地方修复bug和进行更改

### 圈复杂度的概念

![image-20210201210448656](/Users/gertieliang/Library/Application Support/typora-user-images/image-20210201210448656.png)

### 代码可维护行规则

1. 源代码不能有重复代码
2. 不能使用魔数
3. 代码不能被注释
4. 类不能与其他类耦合
5. 函数的圈复杂度不能太高
6. 函数不能太复杂

### code smell识别与消除

![image-20210201210801234](/Users/gertieliang/Library/Application Support/typora-user-images/image-20210201210801234.png)

**对象函数问题**

· 过长函数

· 过长参数列表：引入参数对象，以查询取代参数，移除标记参数

· 基本类型偏执：表现为不愿意在小的问题域上运用对象，优化手段：以对象取代基本类型

· 重复的switch：1. 用策略模式代替 if/switch; 2.表驱动方式；3.责任链模式；4.if语句嵌套太深：抽取方法+卫语句

· 循环语句：以管道取代循环

**对象数据的问题**

· 神秘命名

· 全局数据

· 可变数据：对数据的随意修改经常会导致出乎意料的结果和难以发现的bug

· 数据泥团

· 临时字段

· 纯数据类：将相关的数据和行为集中在一起

**对象关系的问题**

· 发散式变化：一个类因为多个原因被修改，类的功能过多

· 霰弹式修改：增加/修改一个功能，需要修改多个类

· 依恋情结：某个函数为了计算某值，从另一个对象那儿调用了大量的取值函数

· 夸夸其谈通用性：遵循合适原则，不用为未来的无限的可能情况做设计

· 过长的消息链

· 中间人

· 内幕交易：将类的边界定义清晰，公共子类可以提炼出来

· 被拒绝的馈赠：以委托取代继承

**其他问题**



### 应对技术债的不同策略



### 如何偿还技术债



### 如何有效防止新增技术债



### 技术债的由来



### 如何解除模块耦合



### EPC对代码质量管理的要求

